{"version":3,"sources":["webpack:///webpack/bootstrap cfdb1b55debd53cc9653","webpack:///./index.js","webpack:///./src/middleware.js","webpack:///./src/cableCar.js"],"names":["middleware","channel","s","window","console","log","car","store","action","type","unsubscribe","__ActionCable","send","optimistic","next","getState","CableCar","dispatch","msg","Object","assign","initialized","connected","disconnected","received","rejected","data","perform","subscription","ActionCable","initialize","createConsumer","subscriptions","create"],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;ACtCA;;;;;;;;;;;;;;;;;;ACAA;;;;;;AAEA,KAAMA,aAAa,SAAbA,UAAa,CAACC,OAAD,EAAUC,CAAV,EAAgB;AACjCC,UAAOC,OAAP,CAAeC,GAAf,CAAmBH,CAAnB;AACA,OAAII,MAAM,uBAAaL,OAAb,CAAV;;AAEA,UAAO;AAAA,YAAS;AAAA,cAAQ,kBAAU;;AAEhC,aAAG,CAACK,IAAIC,KAAR,EAAe;AACbD,eAAIC,KAAJ,GAAYA,KAAZ;AACD;;AAED,aAAIC,OAAOC,IAAP,KAAgB,uBAApB,EAA6C;AAC3CH,eAAIC,KAAJ,GAAYA,KAAZ;AACD,UAFD,MAEO,IAAIC,OAAOC,IAAP,KAAgB,sBAApB,EAA4C;AACjDH,eAAII,WAAJ;AACD,UAFM,MAEA,IAAI,CAACF,OAAOG,aAAZ,EAA2B;AAChCL,eAAIM,IAAJ,CAASJ,MAAT;AACD;;AAED,gBAAQA,OAAOK,UAAP,IAAqBL,OAAOG,aAA5B,GAA4CG,KAAKN,MAAL,CAA5C,GAA2DD,MAAMQ,QAAN,EAAnE;AAED,QAhBe;AAAA,MAAT;AAAA,IAAP;AAiBD,EArBD;;mBAwBef,U;;;;;;;;;;;;;;;;KC1BTgB,Q;AAEJ,qBAAYf,OAAZ,EAAqB;AAAA;;AAAA;;AAAA,UAqBrBgB,QArBqB,GAqBV,UAACC,GAAD;AAAA,cAAU,MAAKX,KAAL,GAAa,MAAKA,KAAL,CAAWU,QAAX,CAAoBE,OAAOC,MAAP,CAAcF,GAAd,EAAmB,EAACP,eAAe,IAAhB,EAAnB,CAApB,CAAb,GAA8E,KAAxF;AAAA,MArBU;;AAAA,UAwBrBU,WAxBqB,GAwBP;AAAA,cAAM,MAAKJ,QAAL,CAAc,EAAER,MAAM,uBAAR,EAAd,CAAN;AAAA,MAxBO;;AAAA,UA0BrBa,SA1BqB,GA0BT;AAAA,cAAM,MAAKL,QAAL,CAAc,EAAER,MAAM,qBAAR,EAAd,CAAN;AAAA,MA1BS;;AAAA,UA4BrBc,YA5BqB,GA4BN;AAAA,cAAM,MAAKN,QAAL,CAAc,EAAER,MAAM,wBAAR,EAAd,CAAN;AAAA,MA5BM;;AAAA,UA8BrBe,QA9BqB,GA8BV,UAACN,GAAD;AAAA,cAAS,MAAKD,QAAL,CAAcC,GAAd,CAAT;AAAA,MA9BU;;AAAA,UAgCrBO,QAhCqB,GAgCV,UAACC,IAAD,EAAU;AACnB,8FAAqFA,IAArF;AACD,MAlCoB;;AAAA,UAqCrBC,OArCqB,GAqCX,UAACnB,MAAD,EAASkB,IAAT,EAAkB;AAC1B,aAAKE,YAAL,CAAkBD,OAAlB,CAA0BnB,MAA1B,EAAkCkB,IAAlC;AACD,MAvCoB;;AAAA,UAyCrBd,IAzCqB,GAyCd,UAACJ,MAAD;AAAA,cAAY,MAAKoB,YAAL,CAAkBhB,IAAlB,CAAuBJ,MAAvB,CAAZ;AAAA,MAzCc;;AAAA,UA2CrBE,WA3CqB,GA2CP,YAAM;AAClB,aAAKkB,YAAL,CAAkBlB,WAAlB;AACD,MA7CoB;;AAEnB,SAAI,OAAOmB,WAAP,IAAsB,WAA1B,EAAuC;AACrC;AACD;;AAED,UAAK5B,OAAL,GAAeA,OAAf;AACA,UAAKM,KAAL,GAAa,IAAb;AACA,UAAKuB,UAAL;AACD;;;;kCAEY;AACX,YAAKF,YAAL,GAAoBC,YAAYE,cAAZ,GAA6BC,aAA7B,CAA2CC,MAA3C,CAAkD,EAAEhC,SAAS,KAAKA,OAAhB,EAAlD,EAA6E;AAC/FoB,sBAAa,KAAKA,WAD6E;AAE/FC,oBAAW,KAAKA,SAF+E;AAG/FC,uBAAc,KAAKA,YAH4E;AAI/FC,mBAAU,KAAKA,QAJgF;AAK/FC,mBAAU,KAAKA;AALgF,QAA7E,CAApB;AAOD;;AAID;;;AAaA;;;;;;;mBAaaT,Q","file":"cablecar.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap cfdb1b55debd53cc9653","import middleware from './src/middleware';\n\nexport default middleware\n\n\n// WEBPACK FOOTER //\n// ./index.js","import CableCar from './cableCar'\n\nconst middleware = (channel, s) => {\n  window.console.log(s)\n  var car = new CableCar(channel);\n  \n  return store => next => action => {\n\n    if(!car.store) {\n      car.store = store;\n    }\n    \n    if (action.type === 'CABLE_CAR_INITIALIZED') {\n      car.store = store;\n    } else if (action.type === 'DISCONNECT_CABLE_CAR') {\n      car.unsubscribe();\n    } else if (!action.__ActionCable) {\n      car.send(action);\n    }\n    \n    return (action.optimistic || action.__ActionCable ? next(action) : store.getState())\n\n  }\n};\n\n\nexport default middleware\n\n\n// WEBPACK FOOTER //\n// ./src/middleware.js","class CableCar {\n\n  constructor(channel) {\n\n    if (typeof ActionCable == 'undefined') {\n      throw(`CableCar tried to connect to ActionCable but ActionCable is not defined`);\n    }\n\n    this.channel = channel;\n    this.store = null;\n    this.initialize();\n  }\n\n  initialize() {\n    this.subscription = ActionCable.createConsumer().subscriptions.create({ channel: this.channel }, {\n      initialized: this.initialized,\n      connected: this.connected,\n      disconnected: this.disconnected,\n      received: this.received,\n      rejected: this.rejected,\n    });\n  }\n  \n  dispatch = (msg) => (this.store ? this.store.dispatch(Object.assign(msg, {__ActionCable: true})) : false) \n\n  // ActionCable callback functions\n  initialized = () => this.dispatch({ type: 'CABLE_CAR_INITIALIZED' })\n  \n  connected = () => this.dispatch({ type: 'CABLE_CAR_CONNECTED' })\n  \n  disconnected = () => this.dispatch({ type: 'CABLE_CAR_DISCONNECTED' })\n  \n  received = (msg) => this.dispatch(msg)\n  \n  rejected = (data) => {\n    throw(`Attempt to connect Redux store and ActionCable channel via CableCar failed. ${data}`)\n  }\n  \n  // ActionCable subscription functions\n  perform = (action, data) => {\n    this.subscription.perform(action, data);\n  }\n  \n  send = (action) => this.subscription.send(action)\n  \n  unsubscribe = () => {\n    this.subscription.unsubscribe();\n  }\n}\n\n\nexport default CableCar\n\n\n// WEBPACK FOOTER //\n// ./src/cableCar.js"],"sourceRoot":""}