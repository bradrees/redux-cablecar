{"version":3,"sources":["webpack:///cablecar.min.js","webpack:///webpack/bootstrap 68d352cf5b6132c7b619","webpack:///./index.js","webpack:///./src/middleware.js","webpack:///./src/cableCar.js"],"names":["module","exports","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_middleware","_middleware2","_cableCar","_cableCar2","middleware","store","car","next","action","type","unsubscribe","__ActionCable","send","optimistic","getState","connect","channel","options","_classCallCheck","instance","Constructor","TypeError","CableCar","_this","this","arguments","length","undefined","initialize","params","ActionCable","createConsumer","subscriptions","create","initialized","connected","disconnected","received","rejected","dispatch","msg","assign","data","perform","subscription"],"mappings":"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","file":"cablecar.min.js","sourcesContent":["module.exports =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _middleware = __webpack_require__(1);\n\t\n\tvar _middleware2 = _interopRequireDefault(_middleware);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n\texports.default = _middleware2.default;\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _cableCar = __webpack_require__(2);\n\t\n\tvar _cableCar2 = _interopRequireDefault(_cableCar);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar middleware = function middleware(store) {\n\t\n\t  var car;\n\t\n\t  return function (next) {\n\t    return function (action) {\n\t\n\t      if (action.type === 'CABLE_CAR_INITIALIZED') {\n\t        car = action.car;\n\t      } else if (action.type === 'DISCONNECT_CABLE_CAR') {\n\t        car.unsubscribe();\n\t      } else if (!action.__ActionCable) {\n\t        car.send(action);\n\t      }\n\t\n\t      return action.optimistic || action.__ActionCable ? next(action) : store.getState();\n\t    };\n\t  };\n\t};\n\t\n\tmiddleware.connect = function (store, channel, options) {\n\t  return new _cableCar2.default(store, channel, options);\n\t};\n\t\n\texports.default = middleware;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar CableCar = function CableCar(store, channel) {\n\t  var _this = this;\n\t\n\t  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\t\n\t  _classCallCheck(this, CableCar);\n\t\n\t  this.initialize = function (params) {\n\t    return ActionCable.createConsumer().subscriptions.create(params, {\n\t      initialized: _this.initialized,\n\t      connected: _this.connected,\n\t      disconnected: _this.disconnected,\n\t      received: _this.received,\n\t      rejected: _this.rejected\n\t    });\n\t  };\n\t\n\t  this.dispatch = function (msg) {\n\t    return _this.store.dispatch(Object.assign(msg, { __ActionCable: true }));\n\t  };\n\t\n\t  this.initialized = function () {\n\t    return _this.dispatch({ type: 'CABLE_CAR_INITIALIZED', car: _this });\n\t  };\n\t\n\t  this.connected = function () {\n\t    return _this.dispatch({ type: 'CABLE_CAR_CONNECTED' });\n\t  };\n\t\n\t  this.disconnected = function () {\n\t    return _this.dispatch({ type: 'CABLE_CAR_DISCONNECTED' });\n\t  };\n\t\n\t  this.received = function (msg) {\n\t    return _this.dispatch(msg);\n\t  };\n\t\n\t  this.rejected = function (data) {\n\t    _this.dispatch({ type: 'CABLE_CAR_REJECTED' });\n\t    throw 'Attempt to connect Redux store and ActionCable channel via CableCar failed. ' + data;\n\t  };\n\t\n\t  this.perform = function (action, data) {\n\t    return _this.subscription.perform(action, data);\n\t  };\n\t\n\t  this.send = function (action) {\n\t    return _this.subscription.send(action);\n\t  };\n\t\n\t  this.unsubscribe = function () {\n\t    return _this.subscription.unsubscribe();\n\t  };\n\t\n\t  if (typeof ActionCable == 'undefined') {\n\t    throw 'CableCar tried to connect to ActionCable but ActionCable is not defined';\n\t  }\n\t\n\t  this.params = Object.assign({ channel: channel }, options);\n\t  this.store = store;\n\t  this.subscription = this.initialize(this.params);\n\t}\n\t\n\t// Redux dispatch function\n\t\n\t\n\t// ActionCable callback functions\n\t\n\t\n\t// ActionCable subscription functions\n\t;\n\t\n\texports.default = CableCar;\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// cablecar.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 68d352cf5b6132c7b619","import middleware from './src/middleware';\n\nexport default middleware\n\n\n// WEBPACK FOOTER //\n// ./index.js","import CableCar from './cableCar'\n\nconst middleware = store => {\n  \n  var car;\n  \n  return next => action => {\n\n    if (action.type === 'CABLE_CAR_INITIALIZED') {\n      car = action.car;\n    } else if (action.type === 'DISCONNECT_CABLE_CAR') {\n      car.unsubscribe();\n    } else if (!action.__ActionCable) {\n      car.send(action);\n    }\n  \n    return (action.optimistic || action.__ActionCable ? next(action) : store.getState())\n\n  }\n};\n\nmiddleware.connect = (store, channel, options) => new CableCar(store, channel, options)\n\n\nexport default middleware\n\n\n// WEBPACK FOOTER //\n// ./src/middleware.js","class CableCar {\n\n  constructor(store, channel, options = {}) {\n\n    if (typeof ActionCable == 'undefined') {\n      throw(`CableCar tried to connect to ActionCable but ActionCable is not defined`);\n    }\n\n    this.params = Object.assign({ channel: channel }, options);\n    this.store = store;\n    this.subscription = this.initialize(this.params);\n  }\n\n  initialize = (params) => \n    \n    ActionCable.createConsumer().subscriptions.create(params, {\n      initialized: this.initialized,\n      connected: this.connected,\n      disconnected: this.disconnected,\n      received: this.received,\n      rejected: this.rejected,\n    })\n  \n  // Redux dispatch function\n  dispatch = (msg) => this.store.dispatch(Object.assign(msg, {__ActionCable: true}))\n\n  // ActionCable callback functions\n  initialized = () => this.dispatch({ type: 'CABLE_CAR_INITIALIZED', car: this })\n  \n  connected = () => this.dispatch({ type: 'CABLE_CAR_CONNECTED' })\n  \n  disconnected = () => this.dispatch({ type: 'CABLE_CAR_DISCONNECTED' })\n  \n  received = (msg) => this.dispatch(msg)\n  \n  rejected = (data) => {\n    this.dispatch({ type: 'CABLE_CAR_REJECTED' });\n    throw(`Attempt to connect Redux store and ActionCable channel via CableCar failed. ${data}`)\n  }\n  \n  // ActionCable subscription functions\n  perform = (action, data) => this.subscription.perform(action, data)\n  \n  send = (action) => this.subscription.send(action)\n  \n  unsubscribe = () => this.subscription.unsubscribe()\n\n}\n\n\nexport default CableCar\n\n\n// WEBPACK FOOTER //\n// ./src/cableCar.js"],"sourceRoot":""}